<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Computer-Aided Statistical Analysis (B.Sc.) - 1&nbsp; Statistical Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch2_LinearRegression.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Statistical Learning</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./images/Uni_Bonn_Logo.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computer-Aided Statistical Analysis (B.Sc.)</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Organization of the Course</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1_StatLearning.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Statistical Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2_LinearRegression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3_Classification.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4_ResamplingMethods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resampling Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5_LinModSelectRegul.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Model Selection and Regularization</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lecture-notes" id="toc-lecture-notes" class="nav-link active" data-scroll-target="#lecture-notes"><span class="toc-section-number">1.1</span>  Lecture Notes</a></li>
  <li><a href="#what-is-statistical-learning" id="toc-what-is-statistical-learning" class="nav-link" data-scroll-target="#what-is-statistical-learning"><span class="toc-section-number">1.2</span>  What is Statistical Learning?</a>
  <ul class="collapse">
  <li><a href="#why-estimate-f" id="toc-why-estimate-f" class="nav-link" data-scroll-target="#why-estimate-f"><span class="toc-section-number">1.2.1</span>  Why Estimate <span class="math inline">\(f\)</span>?</a></li>
  </ul></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">Prediction</a>
  <ul class="collapse">
  <li><a href="#accuracy-of-a-prediction" id="toc-accuracy-of-a-prediction" class="nav-link" data-scroll-target="#accuracy-of-a-prediction">Accuracy of a Prediction</a></li>
  </ul></li>
  <li><a href="#parameter-inference" id="toc-parameter-inference" class="nav-link" data-scroll-target="#parameter-inference">(Parameter) Inference</a></li>
  <li><a href="#how-do-we-estimate-f" id="toc-how-do-we-estimate-f" class="nav-link" data-scroll-target="#how-do-we-estimate-f"><span class="toc-section-number">1.3</span>  How Do We Estimate <span class="math inline">\(f\)</span>?</a>
  <ul class="collapse">
  <li><a href="#parametric-methods" id="toc-parametric-methods" class="nav-link" data-scroll-target="#parametric-methods">Parametric Methods</a></li>
  <li><a href="#non-parametric-methods" id="toc-non-parametric-methods" class="nav-link" data-scroll-target="#non-parametric-methods">Non-Parametric Methods</a></li>
  <li><a href="#the-trade-off-between-prediction-accuracy-and-model-interpretability" id="toc-the-trade-off-between-prediction-accuracy-and-model-interpretability" class="nav-link" data-scroll-target="#the-trade-off-between-prediction-accuracy-and-model-interpretability"><span class="toc-section-number">1.3.1</span>  The Trade-Off Between Prediction Accuracy and Model Interpretability</a></li>
  <li><a href="#supervised-versus-unsupervised-learning" id="toc-supervised-versus-unsupervised-learning" class="nav-link" data-scroll-target="#supervised-versus-unsupervised-learning"><span class="toc-section-number">1.3.2</span>  Supervised Versus Unsupervised Learning</a></li>
  <li><a href="#regression-versus-classification-problems" id="toc-regression-versus-classification-problems" class="nav-link" data-scroll-target="#regression-versus-classification-problems"><span class="toc-section-number">1.3.3</span>  Regression Versus Classification Problems</a></li>
  </ul></li>
  <li><a href="#assessing-model-accuracy" id="toc-assessing-model-accuracy" class="nav-link" data-scroll-target="#assessing-model-accuracy"><span class="toc-section-number">1.4</span>  Assessing Model Accuracy</a>
  <ul class="collapse">
  <li><a href="#measuring-the-quality-of-fit" id="toc-measuring-the-quality-of-fit" class="nav-link" data-scroll-target="#measuring-the-quality-of-fit"><span class="toc-section-number">1.4.1</span>  Measuring the Quality of Fit</a></li>
  <li><a href="#the-bias-variance-trade-off" id="toc-the-bias-variance-trade-off" class="nav-link" data-scroll-target="#the-bias-variance-trade-off"><span class="toc-section-number">1.4.2</span>  The Bias-Variance Trade-Off</a></li>
  <li><a href="#the-classification-setting" id="toc-the-classification-setting" class="nav-link" data-scroll-target="#the-classification-setting"><span class="toc-section-number">1.4.3</span>  The Classification Setting</a></li>
  <li><a href="#the-bayes-classifier" id="toc-the-bayes-classifier" class="nav-link" data-scroll-target="#the-bayes-classifier">The Bayes Classifier</a></li>
  <li><a href="#k-nearest-neighbors" id="toc-k-nearest-neighbors" class="nav-link" data-scroll-target="#k-nearest-neighbors"><span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
  </ul></li>
  <li><a href="#r-lab-introduction-to-r" id="toc-r-lab-introduction-to-r" class="nav-link" data-scroll-target="#r-lab-introduction-to-r"><span class="toc-section-number">1.5</span>  <code>R</code>-Lab: Introduction to <code>R</code></a>
  <ul class="collapse">
  <li><a href="#short-glossary" id="toc-short-glossary" class="nav-link" data-scroll-target="#short-glossary"><span class="toc-section-number">1.5.1</span>  Short Glossary</a></li>
  <li><a href="#first-steps" id="toc-first-steps" class="nav-link" data-scroll-target="#first-steps"><span class="toc-section-number">1.5.2</span>  First Steps</a></li>
  <li><a href="#further-data-objects" id="toc-further-data-objects" class="nav-link" data-scroll-target="#further-data-objects"><span class="toc-section-number">1.5.3</span>  Further Data Objects</a></li>
  <li><a href="#simple-regression-analysis-using-r" id="toc-simple-regression-analysis-using-r" class="nav-link" data-scroll-target="#simple-regression-analysis-using-r"><span class="toc-section-number">1.5.4</span>  Simple Regression Analysis using R</a></li>
  <li><a href="#programming-in-r" id="toc-programming-in-r" class="nav-link" data-scroll-target="#programming-in-r"><span class="toc-section-number">1.5.5</span>  Programming in <code>R</code></a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages"><span class="toc-section-number">1.5.6</span>  R-packages</a></li>
  <li><a href="#tidyverse" id="toc-tidyverse" class="nav-link" data-scroll-target="#tidyverse"><span class="toc-section-number">1.5.7</span>  Tidyverse</a></li>
  <li><a href="#further-links" id="toc-further-links" class="nav-link" data-scroll-target="#further-links"><span class="toc-section-number">1.5.8</span>  Further Links</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">1.6</span>  Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Statistical Learning</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="lecture-notes" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="lecture-notes"><span class="header-section-number">1.1</span> Lecture Notes</h2>
<p>Reading: Chapter 2 of our course textbook <a href="https://www.statlearning.com/">An Introduction to Statistical Learning</a></p>
</section>
<section id="what-is-statistical-learning" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="what-is-statistical-learning"><span class="header-section-number">1.2</span> What is Statistical Learning?</h2>
<p>Suppose that we observe a quantitative response <span class="math inline">\(Y\)</span> and <span class="math inline">\(p\)</span> different predictors, <span class="math inline">\(X_1, X_2, \dots, X_p.\)</span></p>
<p>We assume that there is some relationship between <span class="math inline">\(Y\)</span> and <span class="math display">\[
X = (X_1, X_2, \dots, X_p),
\]</span> which can be written in the very general form <span class="math display">\[
Y = f(X) + \epsilon.
\]</span></p>
<ul>
<li><span class="math inline">\(f\)</span> is some fixed but unknown function of <span class="math inline">\(X = (X_1, X_2, \dots, X_p).\)</span></li>
<li><span class="math inline">\(\epsilon\)</span> a random error term, which is independent of <span class="math inline">\(X\)</span> and has mean zero.</li>
</ul>
<p>In this formulation, <span class="math inline">\(f\)</span> represents the <em>systematic</em> information that <span class="math inline">\(X\)</span> provides about <span class="math inline">\(Y.\)</span></p>
<p>In essence, <strong>statistical learning</strong> refers to a set of approaches for estimating <span class="math inline">\(f.\)</span> In this chapter we outline some of the key theoretical concepts that arise in estimating <span class="math inline">\(f,\)</span> as well as tools for evaluating the estimates obtained.</p>
<section id="why-estimate-f" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="why-estimate-f"><span class="header-section-number">1.2.1</span> Why Estimate <span class="math inline">\(f\)</span>?</h3>
<p>There are <strong>two main reasons</strong> that we may wish to estimate <span class="math inline">\(f\)</span>:</p>
<ul>
<li>prediction and</li>
<li>inference.</li>
</ul>
<p>We discuss each in turn.</p>
</section>
</section>
<section id="prediction" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="prediction">Prediction</h2>
<p>In many situations, a set of inputs <span class="math inline">\(X\)</span> are readily available, but the output <span class="math inline">\(Y\)</span> cannot be easily obtained. In this setting, since the error term averages to zero, we can predict <span class="math inline">\(Y\)</span> using <span class="math display">\[
\hat{Y} = \hat{f}(X),
\]</span></p>
<ul>
<li><span class="math inline">\(\hat{f}\)</span> represents our estimate for <span class="math inline">\(f\)</span></li>
<li><span class="math inline">\(\hat{Y}\)</span> represents the resulting prediction for <span class="math inline">\(Y\)</span></li>
</ul>
<p>In this setting, <span class="math inline">\(\hat{f}\)</span> is often treated as a <strong>black box</strong>, in the sense that one is not typically concerned with the exact form of <span class="math inline">\(\hat{f},\)</span> provided that it yields accurate predictions for <span class="math inline">\(Y.\)</span></p>
<p><strong>Example:</strong> As an example, suppose that <span class="math inline">\((X_1, X_2, \dots, X_p)\)</span> are characteristics of a patient’s blood sample that can be easily measured in a lab, and <span class="math inline">\(Y\)</span> is a variable encoding the patient’s risk for a severe adverse reaction to a particular drug. It is natural to seek to predict <span class="math inline">\(Y\)</span> using <span class="math inline">\(X,\)</span> since we can then avoid giving the drug in question to patients who are at high risk of an adverse reaction–that is, patients for whom the estimate of <span class="math inline">\(Y\)</span> is high.</p>
<section id="accuracy-of-a-prediction" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="accuracy-of-a-prediction">Accuracy of a Prediction</h3>
<p>The accuracy of <span class="math inline">\(\hat{Y}\)</span> as a prediction for <span class="math inline">\(Y\)</span> depends on two quantities: * the <strong>reducible error</strong> and * the <strong>irreducible error.</strong></p>
<p>In general, <span class="math inline">\(\hat{f}\)</span> will not be a perfect estimate for <span class="math inline">\(f,\)</span> and this inaccuracy will introduce some error. This error is <strong>reducible</strong>, because we can potentially improve the accuracy of <span class="math inline">\(\hat{f}\)</span> by using the most appropriate statistical learning technique to estimate <span class="math inline">\(f.\)</span></p>
<p>However, even if it were possible to form a perfect estimate for <span class="math inline">\(f,\)</span> so that our estimated response took the form <span class="math display">\[
\hat{Y} = f (X),
\]</span> our prediction would still have some error in it! This is because <span class="math inline">\(Y\)</span> is also a function of <span class="math inline">\(\epsilon\)</span> which, by definition, cannot be predicted using <span class="math inline">\(X.\)</span> Therefore, variability associated with <span class="math inline">\(\epsilon\)</span> also affects the accuracy of our predictions. This is known as the <strong>irreducible error</strong>, because no matter how well we estimate <span class="math inline">\(f,\)</span> we cannot reduce the error introduced by <span class="math inline">\(\epsilon.\)</span></p>
<p>Consider a <em>given</em> estimate <span class="math inline">\(\hat{f}\)</span> and a <em>given</em> set of predictors <span class="math inline">\(X,\)</span> which yields the prediction <span class="math inline">\(\hat{Y} = \hat{f}(X).\)</span> Assume for a moment that both <span class="math inline">\(\hat{f}\)</span> and <span class="math inline">\(X\)</span> are fixed, so that the only variability comes from <span class="math inline">\(\epsilon.\)</span> Then, it is easy to show that <span class="math display">\[\begin{align*}
&amp;E\left[(Y - \hat{Y})^2\right]\\
&amp;=E\left[(f(X) + \epsilon - \hat{f}(X))^2\right] \\
&amp;=E\left[\left(f(X) -\hat{f}(X)\right)^2 - \left(f(X) -\hat{f}(X)\right)\epsilon + \epsilon^2\right] \\
% &amp;=E\left[\left(f(X) -\hat{f}(X)\right)^2\right] - E\left[\left(f(X) -\hat{f}(X)\right)\epsilon\right] + E\left[\epsilon^2\right] \\
&amp;=\left(f(X) -\hat{f}(X)\right)^2 - \left(f(X) -\hat{f}(X)\right) E\left[\epsilon\right] + E\left[\epsilon^2\right] \\
&amp;=\left(f(X) -\hat{f}(X)\right)^2 - \left(f(X) -\hat{f}(X)\right) \cdot 0 + Var\left(\epsilon\right) \\
&amp;=\underbrace{\left(f(X) -\hat{f}(X)\right)^2}_{\text{reducable}} + \underbrace{Var\left(\epsilon\right)}_{\text{irreducable}},
\end{align*}\]</span> where <span class="math inline">\(E\left[(Y - \hat{Y})^2\right]\)</span> represents the expected value,of the squared difference between the predicted and actual value of <span class="math inline">\(Y,\)</span> and where <span class="math inline">\(Var(\epsilon)\)</span> represents the variance associated with the error term <span class="math inline">\(\epsilon.\)</span></p>
<p>The focus of this course is on techniques for estimating <span class="math inline">\(f\)</span> with the aim of <strong>minimizing the reducible error</strong>.</p>
<p>It is important to keep in mind that the irreducible error will always provide an upper bound on the accuracy of our prediction for <span class="math inline">\(Y.\)</span> This bound is almost always unknown in practice.</p>
</section>
</section>
<section id="parameter-inference" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="parameter-inference">(Parameter) Inference</h2>
<p>We are often interested in understanding the association between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1,\dots,X_p.\)</span> In this situation we wish to estimate <span class="math inline">\(f,\)</span> but our goal is not necessarily to make predictions for <span class="math inline">\(Y.\)</span> Now <span class="math inline">\(\hat{f}\)</span> cannot be treated as a black box, because we need to know its exact form. In this setting, one may be interested in answering the following questions:</p>
<ul>
<li>Which predictors are associated with the response?</li>
<li>What is the relationship between the response and each predictor?</li>
<li>Can the relationship between <span class="math inline">\(Y\)</span> and each predictor be adequately summarized using a <em>linear equation</em>, or is the relationship more complicated?</li>
</ul>
<p>In this course, we will see a number of examples that fall into the <strong>prediction setting</strong>, the <strong>inference setting</strong>, or a <strong>combination</strong> of the two.</p>
</section>
<section id="how-do-we-estimate-f" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="how-do-we-estimate-f"><span class="header-section-number">1.3</span> How Do We Estimate <span class="math inline">\(f\)</span>?</h2>
<p>We will always assume that we have observed a set of <span class="math inline">\(n\)</span> different data points <span class="math display">\[
\{(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n)\},
\]</span> where <span class="math display">\[
x_i=(x_{i1},x_{i2},\dots,x_{ip})^T
\]</span> for all <span class="math inline">\(i=1,2,\dots,n.\)</span></p>
<p>These <span class="math inline">\(n\)</span> observations are called <strong>training data</strong> because we will use these training observations to train, or teach, our method how to estimate <span class="math inline">\(f.\)</span></p>
<p>Our goal is to find a function <span class="math inline">\(hat{f}\)</span> such that <span class="math display">\[
Y \approx \hat{f}(X)
\]</span> for any observation <span class="math inline">\((X, Y)\)</span>.</p>
<p>Broadly speaking, most statistical learning methods for this task can be characterized as either <strong>parametric</strong> or <strong>non-parametric</strong>.</p>
<section id="parametric-methods" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="parametric-methods">Parametric Methods</h3>
<p>Parametric methods involve a two-step model-based approach.</p>
<ol type="1">
<li><p>First, we make an assumption about the functional form, or shape, of <span class="math inline">\(f.\)</span> For example, a very simple, but often used assumption is that <span class="math inline">\(f\)</span> is linear in <span class="math inline">\(X\)</span>: <span id="eq-linmodeq"><span class="math display">\[
f(X) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p
\tag{1.1}\]</span></span></p></li>
<li><p>After a model has been selected, we need a procedure that uses the training data to fit or train the model. For example, in the case of the linear model <a href="#eq-linmodeq">Equation&nbsp;<span>1.1</span></a>, we need to estimate the parameters <span class="math inline">\(\beta_0,\beta_1,\dots,\beta_p\)</span> such that <span class="math display">\[
Y \approx \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p
\]</span></p></li>
</ol>
<p>Most common estimation technique: <strong>(Ordinary) Least Squares</strong></p>
<p>The parametric model-based approach reduces the problem of estimating <span class="math inline">\(f\)</span> down to one of estimating a set of parameters.</p>
<ul>
<li>Pro: Simple to estimate</li>
<li>Con: Possible model misspecification (Why shall we know that the shape/form of the true <span class="math inline">\(f\)</span>?)</li>
</ul>
<p>We can try to address the problem of model misspecification by choosing flexible models that can fit many different possible functional forms for <span class="math inline">\(f.\)</span></p>
<p><strong>But:</strong> Fitting a more flexible model requires estimating a greater number of parameters. These more complex models can lead to a phenomenon known as <strong>overfitting</strong> the data, which essentially means they follow the errors, or noise, too closely.</p>
<p>These issues are discussed through-out this course.</p>
</section>
<section id="non-parametric-methods" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="non-parametric-methods">Non-Parametric Methods</h3>
<p>Non-parametric methods do not make explicit assumptions about the functional form of <span class="math inline">\(f.\)</span> Instead, they make qualitative assumptions on <span class="math inline">\(f\)</span> being a <em>smooth</em> function (i.e.&nbsp;continuously differentiable).</p>
<p>By avoiding the assumption of a particular, parametric functional form for <span class="math inline">\(f,\)</span> non-parametric methods have the potential to accurately fit a wider range of possible shapes for <span class="math inline">\(f.\)</span></p>
<p>Major disadvantage: Non-parametric methods require a large number of observations to obtain an accurate estimate for <span class="math inline">\(f;\)</span> far more than is typically needed for a parametric approach if the parametric model assumption is correct.</p>
</section>
<section id="the-trade-off-between-prediction-accuracy-and-model-interpretability" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="the-trade-off-between-prediction-accuracy-and-model-interpretability"><span class="header-section-number">1.3.1</span> The Trade-Off Between Prediction Accuracy and Model Interpretability</h3>
<p>One might reasonably ask the following question:</p>
<blockquote class="blockquote">
<p>Why would we ever choose to use a more restrictive method instead of a very flexible approach?</p>
</blockquote>
<p>If we are mainly interested in inference, then restrictive models are much more interpretable. For instance, when inference is the goal, the linear model may be a good choice since it will be quite easy to understand the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1,\dots,X_p.\)</span></p>
<p>By contrast, very flexible approaches, such as purely non-parametric methods, can lead to such complicated estimates of <span class="math inline">\(f\)</span> that it is difficult to understand how any individual predictor <span class="math inline">\(X_j\)</span> is associated with the response <span class="math inline">\(Y.\)</span></p>
<p>In some settings, we are only interested in prediction, and the interpretability of the predictive model is simply not of interest. For instance, if we seek to develop an algorithm to predict the price of a stock, our sole requirement for the algorithm is that it predict accurately–interpretability is not a concern. In such settings, we might expect that it will be best to use the most flexible model available. Right?</p>
<p>Surprisingly, this is not always the case! We will often obtain more accurate predictions using a less flexible method. This phenomenon, which may seem counterintuitive at first glance, has to do with the potential for <strong>overfitting</strong> in highly flexible methods.</p>
</section>
<section id="supervised-versus-unsupervised-learning" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="supervised-versus-unsupervised-learning"><span class="header-section-number">1.3.2</span> Supervised Versus Unsupervised Learning</h3>
<p>Most statistical learning problems fall into one of two categories:</p>
<ul>
<li>supervised or</li>
<li>unsupervised.</li>
</ul>
<p>In supervised learning problems, we observe for each predictor <span class="math inline">\(x_i,\)</span> <span class="math inline">\(i=1,\dots,n,\)</span> also a response <span class="math inline">\(y_i.\)</span></p>
<p>In unsupervised learning problems, we only the predictor <span class="math inline">\(x_i,\)</span> <span class="math inline">\(i=1,\dots,n,\)</span> but not the associated responses <span class="math inline">\(y_i.\)</span></p>
<p>Supervised learning methods:</p>
<ul>
<li>regression analysis</li>
<li>logistic regression</li>
<li>lasso</li>
<li>ridge regression</li>
</ul>
<p>Unsupervised learning methods:</p>
<ul>
<li>cluster analysis (clustering)</li>
<li><span class="math inline">\(K\)</span>-means</li>
</ul>
</section>
<section id="regression-versus-classification-problems" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="regression-versus-classification-problems"><span class="header-section-number">1.3.3</span> Regression Versus Classification Problems</h3>
<p>Variables can be characterized as either <em>quantitative</em> or <em>qualitative</em> (also known as categorical).</p>
<p><strong>Quantitative:</strong> Quantitative variables take on numerical values. Examples include a person’s age, height, or income, the value of a house, and categorical the price of a stock.</p>
<p><strong>Qualitative/Categorial:</strong> Examples of qualitative variables include a person’s marital status (married or not), the brand of product purchased (brand A, B, or C), whether a person defaults on a debt (yes or no), or a cancer diagnosis (Acute Myelogenous Leukemia, Acute Lymphoblastic Leukemia, or No Leukemia).</p>
<p>We tend to refer to problems with a <em>quantitative response</em> as <strong>regression problems</strong>, while those involving a <em>qualitative response</em> are often referred to as <strong>classification problems</strong>.</p>
<p>However, the distinction (regression vs.&nbsp;classification) is not always that crisp. Least squares linear regression is used with a quantitative response, whereas logistic regression is typically used with a qualitative (two-class, or binary). Thus, despite its name, logistic regression is a classification method. But since it estimates class probabilities, it can be thought of as a regression method as well. Some statistical methods, such as K-nearest neighbors can be used in the case of either quantitative or qualitative responses.</p>
</section>
</section>
<section id="assessing-model-accuracy" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="assessing-model-accuracy"><span class="header-section-number">1.4</span> Assessing Model Accuracy</h2>
<p><strong>There is no free lunch in statistics:</strong> no one method dominates all others over all possible data sets. On a particular data set, one specific method may work best, but some other method may work better on a similar but different data set.</p>
<p>Therefore, it is an important task to decide for any given set of data which method produces the best results. Selecting the best approach can be one of the most challenging parts of performing statistical learning in practice.</p>
<section id="measuring-the-quality-of-fit" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="measuring-the-quality-of-fit"><span class="header-section-number">1.4.1</span> Measuring the Quality of Fit</h3>
<p>In the regression setting, the most commonly-used measure is the mean squared (prediction) error (MSE).</p>
<p>The global training (data) MSE is given by <span class="math display">\[\begin{align*}
\operatorname{MSE}_{\text{train}}=\frac{1}{n}\sum_{i=1}^n\left(y_i - \hat{f}(x_i)\right)^2,
\end{align*}\]</span> where</p>
<ul>
<li><span class="math inline">\(\hat{f}\)</span> is computed from the training data</li>
<li><span class="math inline">\(\hat{f}(x_i)\)</span> is the prediction that <span class="math inline">\(\hat{f}\)</span> gives for the <span class="math inline">\(i\)</span>th training data observation.</li>
</ul>
<p>In general, however, we do not really care how well the method works on the training data. In fact, a very flexible (e.g.&nbsp;non-parametric) estimation method will tend to overfit the training data such that <span class="math inline">\(y_i\approx \hat{f}(x_i)\)</span> for all <span class="math inline">\(i=1,\dots,n\)</span> resulting in a training MSE that is close to zero since <span class="math inline">\(\hat{f}(x_i)\)</span> fits also the errors <span class="math inline">\(\epsilon_i.\)</span></p>
<p>We are interested in the accuracy of the predictions that we obtain when we apply our method to previously unseen <strong>test data</strong>.</p>
<p><strong>Example:</strong> Suppose that we are interested in developing an algorithm to predict a stock’s price based on previous stock returns. We can train the method using stock returns from the past 6 months. But we don’t really care how well our method predicts last week’s stock price. We instead care about how well it will predict tomorrow’s price or next month’s price.</p>
<p><strong>Example:</strong> Suppose that we have clinical measurements (e.g.&nbsp;weight, blood pressure, height, age, family history of disease) for a number of patients, as well as information about whether each patient has diabetes. We can use these patients to train a statistical learning method to predict risk of diabetes based on clinical measurements. In practice, we want this method to accurately predict diabetes risk for future patients based on their clinical measurements.</p>
<p>Thus, we want to choose the method that gives the <strong>lowest <em>test</em> MSE</strong>, as opposed to the lowest <em>training</em> MSE.</p>
<p>Let <span class="math inline">\(\hat{f}\)</span> be computed from the training data <span class="math inline">\(\{(x_1,y_1),\dots,(x_n,y_n)\}.\)</span> And let <span class="math display">\[
\{(x_{0},y_{01}),(x_{0},y_{02})\dots,(x_{0},y_{0m})\}
\]</span> denote the set of <span class="math inline">\(m\)</span> test data points <span class="math inline">\(y_{01},\dots,y_{0m}\)</span> for a given predictor value <span class="math inline">\(x_0\)</span>.</p>
<p>Then, the point-wise test MSE at <span class="math inline">\(x_0\)</span> is given by, <span class="math display">\[\begin{align*}
\operatorname{MSE}_{\text{test}}(x_0)= \frac{1}{m}\sum_{i=1}^m\left(y_{0i} - \hat{f}(x_{0})\right)^2.
\end{align*}\]</span></p>
<p>Typically, however, we want that a method has a <em>globally</em> low test MSE, i.e.&nbsp;for all predictor values in the range of <span class="math inline">\(X\)</span>, not only at a certain given value <span class="math inline">\(x_0\)</span>. Let <span class="math display">\[
\{(x_{01},y_{01}),(x_{02},y_{02})\dots,(x_{0m},y_{0m})\}
\]</span> denote the set of <span class="math inline">\(m\)</span> test data points with predictor values <span class="math inline">\(x_{01},\dots,x_{0m}\)</span> in the range of <span class="math inline">\(X\)</span>. Then, the global test MSE is given by, <span class="math display">\[\begin{align*}
\operatorname{MSE}_{\text{test}}=\frac{1}{m}\sum_{i=1}^m\left(y_{0i} - \hat{f}(x_{0i})\right)^2.
\end{align*}\]</span></p>
<p>Note that if <span class="math inline">\(\hat{f}\approx f,\)</span> then <span class="math display">\[
\operatorname{MSE}_{\text{test}}\approx \frac{1}{m}\sum_{i=1}^m\epsilon_i^2
\]</span> estimates the variance of the error term <span class="math inline">\(Var(\epsilon)\)</span>, i.e., equals the <strong>irreducible error component</strong> of the mean squared (prediction) error.</p>
<p><br></p>
<p><img src="images/Fig_2_9.png" class="img-fluid"></p>
<p><br></p>
<p><img src="images/Fig_2_10.png" class="img-fluid"></p>
<p><br></p>
<p><img src="images/Fig_2_11.png" class="img-fluid"></p>
<p><br></p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Coding Challenge
</div>
</div>
<div class="callout-body-container callout-body">
<p>Generate MSE-results similar to those shown in Figures 2.9, 2.10, and 2.11 of our textbook. Discuss your results.</p>
</div>
</div>
<p>In practice, one can usually compute the training MSE with relative ease, but estimating the test MSE is considerably more difficult because usually no test data are available.</p>
<p>As the three examples in Figures 2.9, 2.10, and 2.11 of our textbook illustrate, the flexibility level corresponding to the model with the minimal test MSE can vary considerably.</p>
<p>Throughout this book, we discuss a variety of approaches that can be used in practice to estimate the minimum point of the test MSE.</p>
<p>One important method is <strong>cross-validation</strong>, which is a method for estimating the test MSE using the training data.</p>
</section>
<section id="the-bias-variance-trade-off" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="the-bias-variance-trade-off"><span class="header-section-number">1.4.2</span> The Bias-Variance Trade-Off</h3>
<p>The U-shape observed in the test MSE curves (Figures 2.9–2.11) turns out to be the result of two competing properties of statistical learning methods.</p>
<ul>
<li>Let <span class="math inline">\(x_0\)</span> denote a given value of the predictor <span class="math inline">\(X\)</span></li>
<li>Let <span class="math inline">\(\hat{f}\)</span> be estimated from the training data</li>
<li>Let <span class="math display">\[
Y_0=f(x_0)+\epsilon
\]</span> be the response random variable defined for the given predictor value <span class="math inline">\(x_0.\)</span></li>
<li>Let <span class="math inline">\(Y_{01},\dots,Y_{0m}\)</span> be all independently and identically distributed as <span class="math inline">\(Y_0;\)</span> shortly <span class="math display">\[
Y_{01},\dots,Y_{0m}\overset{\text{iid}}{\sim}Y_0.
\]</span><br>
</li>
<li>Realizations of <span class="math inline">\(Y_{01},\dots,Y_{0m}\)</span> generate the test data at the predictor value <span class="math inline">\(x_0.\)</span></li>
</ul>
<p>One can show that the expected test MSE can be decomposed as following: <span class="math display">\[\begin{align*}
E\left[\operatorname{MSE}_{test}(x_0)\right]
&amp; =E\left[\frac{1}{m}\sum_{i=1}^m\left(Y_{0i}- \hat{f}(x_0)\right)^2\right]\\[2ex]
&amp; =\frac{1}{m}\sum_{i=1}^mE\left[\left(Y_{0i}- \hat{f}(x_0)\right)^2\right]\\[2ex]
&amp; =\frac{1}{m}\,m\,E\left[\left(Y_{0}- \hat{f}(x_0)\right)^2\right]\quad(\text{since $Y_{0i}$ are iid})\\[2ex]
&amp; =E\left[\left(Y_0- \hat{f}(x_0)\right)^2\right]\\[2ex]
%&amp; =E\left[\left(Y_0- \hat{f}(x_0) \underbrace{+f(x_0)-f(x_0)}_{=0}\right)^2\right]\\[2ex]
%&amp; =E\left[\left(\left(f(x_0)-\hat{f}(x_0)\right)+\epsilon\right)^2\right]\\[2ex]
%&amp; =E\left[\left(f(x_0)-\hat{f}(x_0)\right)^2+2\left(f(x_0)-\hat{f}(x_0)\right)\epsilon+\epsilon^2\right]\\[2ex]
%&amp;\quad \text{Since $\epsilon$ (train) and $\hat{f}$ (test) are independent:}\\[2ex]
%&amp; =E\left[\left(f(x_0)-\hat{f}(x_0)\right)^2\right]+0+Var(\epsilon)\\[2ex]
%&amp; =E\left[\left(f(x_0)-\hat{f}(x_0)\underbrace{+E(\hat{f}(x_0))-E(\hat{f}(x_0))}_{=0}\right)^2\right]+Var(\epsilon)\\[2ex]
%&amp; =E\left[\left(-\left\{E(\hat{f}(x_0)) - f(x_0)\right\} - \left\{\hat{f}(x_0)-E(\hat{f}(x_0))\right\}\right)^2\right]+Var(\epsilon)\\[2ex]
&amp;\quad\text{(steps skipped since beyond scope)}\\[2ex]
&amp; = Var\left(\hat{f}(x_0)\right) + \left[\operatorname{Bias}\left(\hat{f}(x_0)\right)\right]^2 + Var\left(\epsilon\right)
\end{align*}\]</span></p>
<p>The <strong>expected MSE</strong> at <span class="math inline">\(x_0,\)</span> <span class="math inline">\(E\left[\operatorname{MSE}_{test}(x_0)\right],\)</span> refers to the average test MSE that we would obtain if we repeatedly estimated <span class="math inline">\(f\)</span> using training data set, and evaluated each at <span class="math inline">\(x_0.\)</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A computed value of <span class="math inline">\(\operatorname{MSE}_{test}(x_0)\)</span> is only <strong>one estimate</strong> of <span class="math inline">\(E\left[\operatorname{MSE}_{test}(x_0)\right].\)</span></p>
<p>To get information about Bias and Variance of a method, we need to approximate <span class="math inline">\(E\left[\operatorname{MSE}_{test}(x_0)\right];\)</span> see <a href="Ch4_ResamplingMethods.html"><span>Chapter&nbsp;4</span></a>.</p>
</div>
</div>
<p>To minimize the expected test MSE, we need to select a statistical learning method that <em>simultaneously</em> achieves <strong>low variance</strong> and <strong>low bias</strong>.</p>
<p>Note that <span class="math display">\[
Var\left(\hat{f}(x_0)\right)\geq 0
\]</span> and that <span class="math display">\[
\left[\operatorname{Bias}\left(\hat{f}(x_0)\right)\right]^2\geq 0.
\]</span> Thus, the expected test MSE can never lie below of <span class="math inline">\(Var(\epsilon),\)</span> i.e. <span class="math display">\[
\begin{align*}
E\left[\operatorname{MSE}_{test}(x_0)\right]
&amp; =E\left[\left(Y_0- \hat{f}(x_0)\right)^2\right]
\geq Var\left(\epsilon\right).
\end{align*}
\]</span></p>
<p>The overall, i.e., global expected test MSE can be computed by averaging <span class="math inline">\(E[(Y_0- \hat{f}(x_0))^2]\)</span> over all possible values of <span class="math inline">\(x_0\)</span> in the test set.</p>
<section id="variance-of-hatf-at-x_0" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="variance-of-hatf-at-x_0">Variance of <span class="math inline">\(\hat{f}\)</span> at <span class="math inline">\(x_0\)</span></h4>
<p><span class="math display">\[
Var(\hat{f}(x_0))=E\left[\left(\hat{f}(x_0) - E\left[\hat{f}(x_0)\right]\right)^2\right]
\]</span> <strong>Variance</strong> refers to the amount by which <span class="math inline">\(\hat{f}\)</span> would change if we estimated it using a different training data set. Since the training data are used to fit the statistical learning method, different training data sets will result in a different <span class="math inline">\(\hat{f}.\)</span> But ideally the estimate for <span class="math inline">\(f\)</span> should not vary too much between training sets. However, if a method has high variance then small changes in the training data can result in large changes in <span class="math inline">\(\hat{f}.\)</span> In general, more flexible statistical methods have higher variance.</p>
<p>The overall, i.e., global variance can be computed by averaging <span class="math inline">\(Var(\hat{f}(x_0))\)</span> over all possible values of <span class="math inline">\(x_0\)</span> in the test set.</p>
</section>
<section id="bias-of-hatf-at-x_0" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="bias-of-hatf-at-x_0">Bias of <span class="math inline">\(\hat{f}\)</span> at <span class="math inline">\(x_0\)</span></h4>
<p><span class="math display">\[
\operatorname{Bias}(\hat{f}(x_0))=E\left[\hat{f}(x_0)\right] - f(x_0)
\]</span> <strong>Bias</strong> refers to the error that is introduced by approximating a real-life problem, which may be extremely complicated, by a much simpler model. Generally, more flexible methods result in less bias. As a general rule, as we use more flexible methods, the variance will increase and the bias will decrease—and vice versa.</p>
<p>The overall, i.e., global bias can be computed by averaging <span class="math inline">\(\operatorname{Bias}(\hat{f}(x_0))\)</span> over all possible values of <span class="math inline">\(x_0\)</span> in the test set.</p>
<p><img src="images/Fig_2_12.png" class="img-fluid"></p>
</section>
</section>
<section id="the-classification-setting" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="the-classification-setting"><span class="header-section-number">1.4.3</span> The Classification Setting</h3>
<p>Setup:</p>
<ul>
<li>Observed training data <span class="math display">\[
\{(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n)\},
\]</span></li>
<li>Qualitative response <span class="math inline">\(y_i\)</span> with categorical class labels (e.g.&nbsp;<span class="math inline">\(y_i\in\{\text{red},\text{blue}\}\)</span>)</li>
<li>The <strong>classifier</strong> <span class="math inline">\(\hat{f}\)</span> is computed from the training data.</li>
<li>Predicted training data class labels: <span class="math display">\[
\hat{y}_i = \hat{f}(x_i)
\]</span></li>
</ul>
<p>The alternative to the training MSE is here the <strong>training error rate</strong> <span class="math display">\[
\frac{1}{n}\sum_{i=1}^nI(y_i\neq \hat{y}_i)
\]</span> which gives the relative frequency of false categorical predictions.</p>
<p>Here, <span class="math display">\[
I(\cdot)
\]</span> is an indicator function with <span class="math inline">\(I(\text{true})=1\)</span> and <span class="math inline">\(I(\text{false})=0.\)</span></p>
<p>Let <span class="math display">\[
\{(y_{01},x_{01}), (y_{02},x_{02}),\dots, (y_{0m},x_{0m})\}
\]</span> denote <span class="math inline">\(m\)</span> test data observations.</p>
<p>The alternative to the test MSE is here the <strong>test error rate</strong> <span class="math display">\[
\frac{1}{m}\sum_{i=1}^mI(y_{0i}\neq \hat{y}_{0i}),
\]</span> where <span class="math inline">\(\hat{y}_{0i}\)</span> is the predicted class label that results from applying the classifier <span class="math inline">\(\hat{f}\)</span> (computed from the training data) to the test observation with predictor value <span class="math inline">\(x_{i0}.\)</span></p>
<p>A good classifier is one for which the test error rate is smallest.</p>
</section>
<section id="the-bayes-classifier" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-bayes-classifier">The Bayes Classifier</h3>
<p>It is possible to show (proof is outside of the scope of this course) that the test error rate is minimized, on average, by a very simple classifier that assigns each observation <span class="math inline">\(i\)</span> to the most likely class, given its predictor values <span class="math inline">\(x_{0}\)</span>.</p>
<p>In other words, we should simply assign a test observation with predictor vector <span class="math inline">\(x_{0}\)</span> to the class <span class="math inline">\(j\)</span> for which <span class="math display">\[
P(Y = j | X = x_{0})
\]</span> is largest.</p>
<p>This very simple classifier is called the <strong>Bayes classifier</strong>.</p>
<p>In a two-class problem where there are only two possible response values, say class <span class="math inline">\(1\)</span> or class <span class="math inline">\(2,\)</span> the Bayes classifier corresponds to predicting class <span class="math inline">\(1\)</span> if <span class="math display">\[
P(Y = 1| X = x_0 ) &gt; 0.5,
\]</span> and class two otherwise.</p>
<p>The Bayes classifier produces the lowest possible test error rate, called the <strong>Bayes error rate</strong>. The point-wise Bayes error rate at <span class="math inline">\(x_0\)</span> is given by <span class="math display">\[
1 - \max_{j}P(Y = 1| X = x_0 ),
\]</span> where the maximization is over all class labels <span class="math inline">\(j\)</span> (e.g.&nbsp;<span class="math inline">\(j\in\{1,2\}\)</span>)</p>
<p>The global overall Bayes error rate is given by <span class="math display">\[
1 - E\left(\max_{j}P(Y = 1| X )\right),
\]</span> where the expectation averages the probability over all possible values of <span class="math inline">\(X.\)</span></p>
</section>
<section id="k-nearest-neighbors" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="k-nearest-neighbors"><span class="math inline">\(K\)</span>-Nearest Neighbors</h3>
<p>In theory we would always like to predict qualitative responses using the Bayes classifier. But for real data, we do not know the conditional distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X,\)</span> and so computing the Bayes classifier is impossible.</p>
<p>Many approaches attempt to estimate the conditional distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X,\)</span> and then classify a given observation to the class with highest estimated probability. One such method is the <strong><span class="math inline">\(K\)</span>-nearest neighbors</strong> (KNN) classifier.</p>
<p>Given a positive integer <span class="math inline">\(K\)</span> and a test observation <span class="math inline">\(x_0,\)</span> the KNN classifier first identifies the <span class="math inline">\(K\)</span> points in the training data <span class="math display">\[
\{(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n)\},
\]</span> that are closest to <span class="math inline">\(x_0,\)</span> represented by <span class="math display">\[
\mathcal{N}_0=\{i=1,\dots,n \;|\; x_i \text{ is the $K$th closest point to }x_0 \text{ or closter}\}.
\]</span> I.e. <span class="math inline">\(\mathcal{N}_0\)</span> is an index set that allows to select the <span class="math inline">\(K\)</span> nearest neighbors in the training data.</p>
<ul>
<li><span class="math inline">\(\mathcal{N}_0\subset\{1,2,\dots,n\}\)</span></li>
<li><span class="math inline">\(|\mathcal{N}_0|=K\)</span></li>
</ul>
<p>KNN estimates the conditional probability for class <span class="math inline">\(j\)</span> as the fraction of points in <span class="math inline">\(\mathcal{N}_0\)</span> whose response value <span class="math inline">\(y_i\)</span> equals <span class="math inline">\(j:\)</span> <span id="eq-DefKNN"><span class="math display">\[
\begin{align}
P(Y = j | X = x_{0})
&amp;\approx \hat{P}(Y = j | X = x_{0})\\[2ex]
&amp;= \frac{1}{K}\sum_{i\in\mathcal{N}_0}I(y_i = j)
\end{align}
\tag{1.2}\]</span></span> Finally, KNN classifies the test observation <span class="math inline">\(x_0\)</span> to the class <span class="math inline">\(j\)</span> with the largest probability from <a href="#eq-DefKNN">Equation&nbsp;<span>1.2</span></a>.</p>
<p>Figure 2.14 provides an illustrative example of the KNN approach. In the left-hand panel, a small training data set is shown consisting of six blue and six orange observations. Our goal is to make a prediction for the point labeled by the black cross. In the right-hand panel of Figure 2.14 we have applied the KNN approach with <span class="math inline">\(K = 3\)</span> at all of the possible values for <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2,\)</span> and have drawn in the corresponding KNN decision boundary.</p>
<p><br></p>
<p><img src="images/Fig_2_14.png" class="img-fluid"></p>
<p><br></p>
<p><img src="images/Fig_2_15.png" class="img-fluid"></p>
<p><br></p>
<p><img src="images/Fig_2_16.png" class="img-fluid"></p>
<p><br></p>
<p><img src="images/Fig_2_17.png" class="img-fluid"></p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Coding Challenge
</div>
</div>
<div class="callout-body-container callout-body">
<p>Generate classification results similar to those shown in Figures 2.15 and 2.16 of our textbook. Discuss your results.</p>
</div>
</div>
</section>
</section>
<section id="r-lab-introduction-to-r" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="r-lab-introduction-to-r"><span class="header-section-number">1.5</span> <code>R</code>-Lab: Introduction to <code>R</code></h2>
<p>This tutorial aims to serve as an introduction to the software package <code>R</code>. Other very good and much more exhaustive tutorials and useful reference-cards can be found at the following links:</p>
<ul>
<li><a href="http://cran.r-project.org/doc/contrib/refcard.pdf">Reference card for R commands</a> (always useful)</li>
<li><a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf">The official Introduction to R</a> (very detailed)</li>
<li>And many more at <a href="https://www.r-project.org/other-docs.html">www.r-project.org</a> (see “Documents”) <!-- *  An interactive introduction can be done online at: [www.datacamp.com](https://www.datacamp.com/) --></li>
<li>An R-package for learning R: <a href="https://swirlstats.com/">www.swirl.com</a></li>
<li>An excellent book project which covers also advanced issues such as “writing performant code” and “package development”: <a href="http://adv-r.had.co.nz/">adv-r.had.co.nz</a><br>
</li>
<li>Another excellent book: <a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
</ul>
<p>Some other tutorials:</p>
<ul>
<li><a href="https://idc9.github.io/stor390/">Introduction to data science</a></li>
<li><a href="https://gganimate.com/">Creating dynamic graphics</a></li>
</ul>
<p>Why <code>R</code>?</p>
<ul>
<li><code>R</code> is <strong>free</strong> of charge from: <a href="https://www.r-project.org/">www.r-project.org</a></li>
<li>The celebrated IDE <strong>RStudio</strong> for R is also <strong>free</strong> of charge: <a href="http://www.rstudio.com/">www.rstudio.com</a></li>
<li>R is equipped with one of the most flexible and powerful graphics routines available anywhere. For instance, check out one of the following repositories:
<ul>
<li><a href="http://shinyapps.org/apps/RGraphCompendium/index.php">Clean Graphs</a></li>
<li><a href="http://www.sthda.com/english/rpkgs/ggpubr/">Publication Ready Plots</a></li>
</ul></li>
<li>Today, R is the de-facto standard for statistical science.</li>
</ul>
<section id="short-glossary" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="short-glossary"><span class="header-section-number">1.5.1</span> Short Glossary</h3>
<p>Lets start the tutorial with a (very) short glossary:</p>
<ul>
<li><strong>Console</strong>: The thing with the <code>&gt;</code> sign at the beginning.</li>
<li><strong>Script file</strong>: An ordinary text file with suffix <code>.R</code>. For instance, <code>yourFavoritFileName.R</code>.</li>
<li><strong>Working directory</strong>: The file-directory you are working in. Useful commands: with <code>getwd()</code> you get the location of your current working directory and <code>setwd()</code> allows you to set a new location for it.</li>
<li><strong>Workspace</strong>: This is a hidden file (stored in the working directory), where all objects you use (e.g., data, matrices, vectors, variables, functions, etc.) are stored. Useful commands: <code>ls()</code> shows all elements in our current workspace and <code>rm(list=ls())</code> deletes all elements in our current workspace.</li>
</ul>
</section>
<section id="first-steps" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="first-steps"><span class="header-section-number">1.5.2</span> First Steps</h3>
<p>A good idea is to use a script file such as <code>yourFavoritFileName.R</code> in order to store your <code>R</code> commands. You can send single lines or marked regions of your R-code to the console by pressing the keys <strong>STRG+ENTER</strong>.</p>
<p>To begin with baby steps, do some simple computations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span> <span class="co"># and all the others: *,/,-,^2,^3,... </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Note: Everything that is written after the <code>#</code>-sign is ignored by <code>R</code>, which is very useful to comment your code.</p>
<p>The <strong>assignment operator</strong> <code>&lt;-</code> or <code>=</code> will be your most often used tool. Here an example to create a <strong>scalar</strong> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="ot">-&gt;</span> x <span class="co"># possible but unusual</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Note: The <code>R</code> community loves the <code>&lt;-</code> assignment operator, which is a very unusual syntax. Alternatively, you can use the more common <code>=</code> operator which is also used in languages like python or matlab.</p>
<p>And now a more interesting object - a <strong>vector</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 7 4 1</code></pre>
</div>
</div>
<p>The command <code>ls()</code> shows the total content of your current workspace, and the command <code>rm(list=ls())</code> deletes all elements of your current workspace:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x" "y"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
<p>Note: RStudio’s <strong>Environment</strong> pane also lists all the elements in your current workspace. That is, the command <code>ls()</code> becomes a bit obsolete when working with RStudio.</p>
<p>Let’s try how we can compute with vectors and scalars in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span>y <span class="co"># each element in the vector, y, is multiplied by the scalar, x.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 28 16  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">*</span>y <span class="co"># this is a term by term product of the elements in y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 49 16  1</code></pre>
</div>
</div>
<p>Performing vector multiplications as you might expect from your last math-course, e.g., an outer product: <span class="math inline">\(y\,y^\top\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">%*%</span> <span class="fu">t</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    4   14    8    2
[2,]   14   49   28    7
[3,]    8   28   16    4
[4,]    2    7    4    1</code></pre>
</div>
</div>
<p>Or an inner product <span class="math inline">\(y^\top y\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(y) <span class="sc">%*%</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   70</code></pre>
</div>
</div>
<p>Note: Sometimes, R’s treatment of vectors can be annoying. The product <code>y %*% y</code> is treated as the product <code>t(y) %*% y</code>.</p>
<p>The term-by-term execution as in the above example, <code>y*y</code>, is actually a central strength of R. We can conduct many operations <strong>vector-wisely</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 49 16  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6931472 1.9459101 1.3862944 0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    7.389056 1096.633158   54.598150    2.718282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">-</span><span class="fu">mean</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.5  3.5  0.5 -2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(y<span class="sc">-</span><span class="fu">mean</span>(y))<span class="sc">/</span><span class="fu">sd</span>(y) <span class="co"># standardization </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5669467  1.3228757  0.1889822 -0.9449112</code></pre>
</div>
</div>
<p>This is a central characteristic of so called matrix based languages like R (or Matlab). Other programming languages often have to use <strong>loops</strong> instead:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span>N</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>y.sq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>y.sq</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  y.sq[i] <span class="ot">&lt;-</span> y[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> N){</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(y.sq)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>for()</code>-loop is the most common loop. But there is also a <code>while()</code>-loop and a <code>repeat()</code>-loop. However, loops in R can be rather slow, therefore, try to avoid them!</p>
<!-- Try to write your own loop, which computes the element-wise logarithms of a vector `y` and finally prints these values as well as their mean!  -->
<p>Useful commands to produce <strong>sequences</strong> of numbers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>?seq <span class="co"># Help for the seq()-function</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">100</span>, <span class="at">by=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the sequence command <code>1:16</code>, we can go for our first <strong>matrix</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>?matrix</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14
[3,]    3    7   11   15
[4,]    4    8   12   16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that a matrix has always two <strong>dimensions</strong>, but a vector has only one dimension:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(A)    <span class="co"># Dimension of matrix A?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(y)    <span class="co"># dim() does not operate on vectors.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y) <span class="co"># Length of vector y?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Lets play a bit with the matrix <code>A</code> and the vector <code>y</code>. As we have seen in the loop above, the <code>[]</code>-operator <strong>selects elements</strong> of vectors and matrices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>A[,<span class="dv">1</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">4</span>,<span class="dv">4</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>y[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This can be done on a more <strong>logical</strong> basis, too. For example, if you want to know which elements in the first column of matrix <code>A</code> are strictly greater than 2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>A[,<span class="dv">1</span>][A[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that this give you a boolean vector:</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>A[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And you can use it in a non-sense relation, too:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y[A[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1</code></pre>
</div>
</div>
<p>Note: Logical operations return so-called <strong>boolean</strong> objects, i.e., either a <code>TRUE</code> or a <code>FALSE</code>. For instance, if we ask R whether <code>1&gt;2</code> we get the answer <code>FALSE</code>.</p>
</section>
<section id="further-data-objects" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="further-data-objects"><span class="header-section-number">1.5.3</span> Further Data Objects</h3>
<p>Besides classical data objects such as scalars, vectors, and matrices there are three further data objects in R:</p>
<ol type="1">
<li>The <strong>array</strong>: As a matrix but with more dimensions. Here is an example of a <span class="math inline">\(2\times 2\times 2\)</span>-dimensional <code>array</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>myFirst.Array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># Take a look at it!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>The <strong>list</strong>: In <code>lists</code> you can organize different kinds of data. E.g., consider the following example:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>myFirst.List <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Some_Numbers"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">76</span>, <span class="dv">55</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">66</span>, <span class="dv">8</span>, <span class="dv">99</span>), </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Animals"</span>      <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Rabbit"</span>, <span class="st">"Cat"</span>, <span class="st">"Elefant"</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"My_Series"</span>    <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A very useful function to find specific values and entries within lists is the <code>str()</code>-function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(myFirst.List)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ Some_Numbers: num [1:8] 66 76 55 12 4 66 8 99
 $ Animals     : chr [1:3] "Rabbit" "Cat" "Elefant"
 $ My_Series   : int [1:30] 30 29 28 27 26 25 24 23 22 21 ...</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>The <strong>data frame</strong>: A <code>data.frame</code> is a <code>list</code>-object but with some more formal restrictions (e.g., equal number of rows for all columns). As indicated by its name, a <code>data.frame</code>-object is designed to store data:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>myFirst.Dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Credit_Default"</span>   <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Age"</span>              <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">41</span>,<span class="dv">55</span>,<span class="dv">36</span>,<span class="dv">44</span>,<span class="dv">26</span>), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Loan_in_1000_EUR"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">55</span>,<span class="dv">65</span>,<span class="dv">23</span>,<span class="dv">12</span>,<span class="dv">98</span>,<span class="dv">76</span>)) </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at it!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simple-regression-analysis-using-r" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="simple-regression-analysis-using-r"><span class="header-section-number">1.5.4</span> Simple Regression Analysis using R</h3>
<p>Alright, let’s do some statistics with real data. You can download the data <a href="https://github.com/lidom/Teaching_Repo">HERE</a>. Save it on your computer, at a place where you can find it, and give the path (e.g.&nbsp;<code>"C:\textbackslash path\textbackslash auto.data.csv"</code>, which references to the data, to the <em>file</em>-argument of the function <code>read.csv()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ATTENTION</span><span class="co">! YOU HAVE TO CHANGE "\" TO "/":</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>auto.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/your_path/autodata.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(auto.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you have problems to read the data into R, go on with these commands. (For this you need a working internet connection!):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("readr")</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"readr"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>auto.data <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cdn.rawgit.com/lidom/Teaching_Repo/bc692b56/autodata.csv"</span>,<span class="at">col_names =</span> <span class="cn">TRUE</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(auto.data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can select specific variables of the <code>auto.data</code> using the <code>$</code>-operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>gasolin.consumption      <span class="ot">&lt;-</span> auto.data<span class="sc">$</span>MPG.city</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>car.weight               <span class="ot">&lt;-</span> auto.data<span class="sc">$</span>Weight</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Take a look at the first elements of these vectors:</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(gasolin.consumption,car.weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     gasolin.consumption car.weight
[1,]                  25       2705
[2,]                  18       3560
[3,]                  20       3375
[4,]                  19       3405
[5,]                  22       3640
[6,]                  22       2880</code></pre>
</div>
</div>
<p>This is how you can produce your first plot:</p>
<div class="cell" data-fig.margin="true" data-hash="Ch1_StatLearning_cache/html/fig-margin_c8f4407057401b7d25de928c65c38fc8">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the data:</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>gasolin.consumption, <span class="at">x=</span>car.weight, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Car-Weight (US-Pounds)"</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Consumption (Miles/Gallon)"</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Buy Light-Weight Cars!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-margin" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/fig-margin-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.1: Scatterplot of Gasoline consumption (mpg) vs.&nbsp;car weight.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As a first step, we might assume a simple kind of linear relationship between the variables <code>gasolin.consumption</code> and <code>car.weight</code>. Let us assume that the data was generated by the following simple regression model: <span class="math display">\[
y_i=\alpha+\beta_1 x_i+\varepsilon_i,\quad i=1,\dots,n
\]</span> where <span class="math inline">\(y_i\)</span> denotes the gasoline-consumption, <span class="math inline">\(x_i\)</span> the weight of car <span class="math inline">\(i\)</span>, and <span class="math inline">\(\varepsilon_i\)</span> is a mean zero constant variance noise term. (This is clearly a non-sense model!)</p>
<p>The command <code>lm()</code> computes the estimates of this linear regression model. The command (in fact it’s a <em>method</em>) <code>summary()</code> computes further quantities of general interest from the <em>object</em> that was returned from the <code>lm()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>lm.result   <span class="ot">&lt;-</span> <span class="fu">lm</span>(gasolin.consumption<span class="sc">~</span>car.weight)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>lm.summary  <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm.result)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>lm.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gasolin.consumption ~ car.weight)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.7946 -1.9711  0.0249  1.1855 13.8278 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 47.048353   1.679912   28.01   &lt;2e-16 ***
car.weight  -0.008032   0.000537  -14.96   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.038 on 91 degrees of freedom
Multiple R-squared:  0.7109,    Adjusted R-squared:  0.7077 
F-statistic: 223.8 on 1 and 91 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Of course, we want to have a possibility to access all the quantities computed so far, e.g., in order to plot the results. This can be done as following:</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Accessing the computed quantities</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lm.summary) <span class="do">## Alternatively: str(lm.summary)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> lm.summary<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> lm.summary<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot all:</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>gasolin.consumption, <span class="at">x=</span>car.weight, </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Car-Weight (US-Pounds)"</span>, </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Consumption (Miles/Gallon)"</span>, </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Buy light-weight Cars!"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span>alpha, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">b=</span>beta, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Scatterplot of Gasoline consumption (mpg) vs.&nbsp;car weight plus linear regression fit.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="programming-in-r" class="level3" data-number="1.5.5">
<h3 data-number="1.5.5" class="anchored" data-anchor-id="programming-in-r"><span class="header-section-number">1.5.5</span> Programming in <code>R</code></h3>
<p>Let’s write, i.e., program our own <code>R</code>-function for estimating linear regression models. In order to be able to validate our function, we start with <strong>simulating data</strong> for which we then <em>know</em> all true parameters.</p>
<p>Simulating data is like being the “Data-God”: For instance, we generate realizations of the error term <span class="math inline">\(\varepsilon_i\)</span>, i.e., something which we <em>never</em> observe in real data.</p>
<p>Let us consider the following multiple regression model:</p>
<p><span class="math display">\[y_i=\beta_1 +\beta_2 x_{2i}+\beta_3 x_{3i}+\varepsilon_{i},\quad i=1,\dots,n,\]</span> where <span class="math inline">\(\varepsilon_{i}\)</span> is a heteroscedastic error term <span class="math display">\[\varepsilon_{i}\sim N(0,\sigma_i^2),\quad \sigma_i=|x_{3i}|,\]</span></p>
<p>and where for all <span class="math inline">\(i=1,\dots,n=50\)</span>:</p>
<ul>
<li><span class="math inline">\(x_{2i}\sim N(10,1.5^2)\)</span></li>
<li><span class="math inline">\(x_{3i}\)</span> comes from a t-distribution with 5 degrees of freedom and non-centrality parameter 2</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>) <span class="co"># Sets the "seed" of the random number generators:</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>n   <span class="ot">&lt;-</span> <span class="dv">50</span>     <span class="co"># Number of observations</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate two explanatory variables plus an intercept-variable:</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>X<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n)                 <span class="co"># Intercept</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>X<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="fl">1.5</span>) <span class="co"># Draw realizations form a normal distr.</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>X<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">rt</span>(n, <span class="at">df=</span><span class="dv">5</span>, <span class="at">ncp=</span><span class="dv">2</span>)        <span class="co"># Draw realizations form a t-distr.</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>X   <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X<span class="fl">.1</span>, X<span class="fl">.2</span>, X<span class="fl">.3</span>)      <span class="co"># Save as a Nx3-dimensional data matrix.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>OK, we have regressors, i.e., data that we also have in real data sets.</p>
<p>Now we define the elements of the <span class="math inline">\(\beta\)</span>-vector. Be aware of the difference: In real data sets we do not know the true <span class="math inline">\(\beta\)</span>-vector, but try to estimate it. However, when simulating data, we determine (as “Data-Gods”) the true <span class="math inline">\(\beta\)</span>-vector and can compare our estimate <span class="math inline">\(\hat{\beta}\)</span> with the true <span class="math inline">\(\beta\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the slope-coefficients</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>beta.vec  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We still need to simulate realizations of the dependent variable <span class="math inline">\(y_i\)</span>. Remember that <span class="math inline">\(y_i=\beta_1 x_{1i}+\beta_1 x_{2i}+\beta_3 x_{3i}+\varepsilon_{i}\)</span>. That is, we only need realizations from the error terms <span class="math inline">\(\varepsilon_i\)</span> in order to compute the realizations from <span class="math inline">\(y_i\)</span>. This is how you can simulate realizations from the heteroscedastic error terms <span class="math inline">\(\varepsilon_i\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate realizations from the heteroscadastic error term</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>eps       <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fu">abs</span>(X<span class="fl">.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take a look at the heteroscedasticity in the error term:</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>eps, <span class="at">x=</span>X<span class="fl">.3</span>, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Realizations of the </span><span class="sc">\n</span><span class="st">Heteroscedastic Error Term"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Scatterplot of error term realizations (usually unknown) versus the predictor values of X.3.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>With the (pseudo-random) realizations from <span class="math inline">\(\varepsilon_i\)</span>, we can finally generate realizations from the dependent variable <span class="math inline">\(y_i\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dependent variable:</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>y   <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta.vec <span class="sc">+</span> eps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a look at the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mydata    <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Y"</span><span class="ot">=</span>y, <span class="st">"X.1"</span><span class="ot">=</span>X<span class="fl">.1</span>, <span class="st">"X.2"</span><span class="ot">=</span>X<span class="fl">.2</span>, <span class="st">"X.3"</span><span class="ot">=</span>X<span class="fl">.3</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mydata[,<span class="sc">-</span><span class="dv">2</span>]) <span class="co"># The '-2' removes the intercept variable "X.1"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ch1_StatLearning_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Once we have data, we can compute the OLS estimate of the true <span class="math inline">\(\beta\)</span> vector. Remember the formula: <span class="math display">\[\hat{\beta}=(X^\top X)^{-1}X^\top y\]</span> In R-Code this is: <span class="math inline">\((X^\top X)^{-1}=\)</span><code>solve(t(X) %*% X)</code>, i.e.:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Computation of the beta-Vector:</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>beta.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
X.1 -2.609634
X.2 -4.692735
X.3  5.078342</code></pre>
</div>
</div>
<p>Well done. Using the above lines of code we can easily program our own <code>myOLSFun()</code> function!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>myOLSFun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, x, <span class="at">add.intercept=</span><span class="cn">FALSE</span>){</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Number of Observations:</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  n         <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Add an intercept to x:</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(add.intercept){</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    Intercept <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    x         <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Intercept, x)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimation of the slope-parameters:</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  beta.hat.vec <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(x) <span class="sc">%*%</span> x) <span class="sc">%*%</span> <span class="fu">t</span>(x) <span class="sc">%*%</span> y</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Return the result:</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(beta.hat.vec)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Run the function:</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="fu">myOLSFun</span>(<span class="at">y=</span>y, <span class="at">x=</span>X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
X.1 -2.609634
X.2 -4.692735
X.3  5.078342</code></pre>
</div>
</div>
<p>Can you extend the function for the computation of the covariance matrix of the slope-estimates, several measures of fits (R<span class="math inline">\(^2\)</span>, adj.-R<span class="math inline">\(^2\)</span>, etc.), t-tests, …?</p>
</section>
<section id="r-packages" class="level3" data-number="1.5.6">
<h3 data-number="1.5.6" class="anchored" data-anchor-id="r-packages"><span class="header-section-number">1.5.6</span> R-packages</h3>
<p>One of the best features in R are its contributed packages. The list of all packages on CRAN is impressive! Take a look at it <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">HERE</a></p>
<p>For instance, nice plots can be produced using the R-package is <code>ggplot2</code>. You can find an intro do this package <a href="http://ggplot2.tidyverse.org/">HERE</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(Sepal.Length, Petal.Length, <span class="at">data =</span> iris, <span class="at">color =</span> Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Of course, <code>ggplot2</code> concerns “only” plotting, but you’ll find <code>R</code>-packages for almost any statistical method out there.</p>
</section>
<section id="tidyverse" class="level3" data-number="1.5.7">
<h3 data-number="1.5.7" class="anchored" data-anchor-id="tidyverse"><span class="header-section-number">1.5.7</span> Tidyverse</h3>
<p>The <code>tidyverse</code> package is a collection of packages that lets you import, manipulate, explore, visualize and model data in a harmonized and consistent way which helps you to be more productive.</p>
<p>Installing the <code>tidyverse</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To use the <code>tidyverse</code> package load it using the <code>library()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.0     ✔ stringr   1.5.0
✔ forcats   1.0.0     ✔ tibble    3.1.8
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p><strong>Chick Weight Data</strong></p>
<p><code>R</code> comes with many datasets installed. We will use the <code>ChickWeight</code> dataset to learn (a little) about the tidyverse. The help system gives a basic summary of the experiment from which the data was collect:</p>
<blockquote class="blockquote">
<p><em>“The body weights of the chicks were measured at birth and every second day thereafter until day 20. They were also measured on day 21. There were four groups of chicks on different protein diets.”</em></p>
</blockquote>
<p>You can get more information, including references by typing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="st">"ChickWeight"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The Data: </strong> There are 578 observations (rows) and 4 variables:</p>
<ul>
<li><code>Chick</code> – unique ID for each chick.</li>
<li><code>Diet</code> – one of four protein diets.</li>
<li><code>Time</code> – number of days since birth.</li>
<li><code>weight</code> – body weight of chick in grams.</li>
</ul>
<p>Note: <code>weight</code> has a lower case <code>w</code> (recall R is case sensitive).</p>
<p>Store the data locally:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>ChickWeight <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Chick, Diet, Time, weight) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Chick, Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">"DATA/ChickWeight.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First we will import the data from a file called <code>ChickWeight.csv</code> using the <code>read_csv()</code> function from the <code>readr</code> package (part of the <code>tidyverse</code>). The first thing to do, outside of R, is to open the file <code>ChickWeight.csv</code> to check what it contains and that it makes sense. Now we can import the data as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>CW <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"DATA/ChickWeight.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 578 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): Chick, Diet, Time, weight

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>If all goes well then the data is now stored in an R object called <code>CW</code>. If you get the following error message then you need to change the working directory to where the data is stored:</p>
<blockquote class="blockquote">
<p>Error: ‘ChickWeight.csv’ does not exist in current working directory …</p>
</blockquote>
<p><strong>Changing the working directory:</strong> In RStudio you can use the menu bar (“Session - Set Working Directory - Choose Directory…”). Alternatively, you can use the function <code>setwd()</code>. Last but not least, to avoid issues with brocken paths to files and data sets, use RStudios’ “Project” tools.</p>
<p><strong>Looking at the Dataset:</strong> To look at the data type just type the object (dataset) name:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>CW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
   Chick  Diet  Time weight
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1    18     1     0     39
 2    18     1     2     35
 3    16     1     0     41
 4    16     1     2     45
 5    16     1     4     49
 6    16     1     6     51
 7    16     1     8     57
 8    16     1    10     51
 9    16     1    12     54
10    15     1     0     41
# … with 568 more rows</code></pre>
</div>
</div>
<p>If there are too many variables then not all them may be printed. To overcome this issue we can use the <code>glimpse()</code> function which makes it possible to see every column in your dataset (called a “data frame” in R speak).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(CW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 578
Columns: 4
$ Chick  &lt;dbl&gt; 18, 18, 16, 16, 16, 16, 16, 16, 16, 15, 15, 15, 15, 15, 15, 15,…
$ Diet   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ Time   &lt;dbl&gt; 0, 2, 0, 2, 4, 6, 8, 10, 12, 0, 2, 4, 6, 8, 10, 12, 14, 0, 2, 4…
$ weight &lt;dbl&gt; 39, 35, 41, 45, 49, 51, 57, 51, 54, 41, 49, 56, 64, 68, 68, 67,…</code></pre>
</div>
</div>
<p>The function <code>View()</code> allows for a spread-sheet type of view on the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(CW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tidyverse-plotting-basics" class="level4" data-number="1.5.7.1">
<h4 data-number="1.5.7.1" class="anchored" data-anchor-id="tidyverse-plotting-basics"><span class="header-section-number">1.5.7.1</span> Tidyverse: Plotting Basics</h4>
<p>To <strong>visualize</strong> the chick weight data, we will use the <code>ggplot2</code> package (part of the <code>tidyverse</code>). Our interest is in seeing how the <em>weight changes over time for the chicks by diet</em>. For the moment don’t worry too much about the details just try to build your own understanding and logic. To learn more try different things even if you get an error messages.</p>
<p>Let’s plot the weight data (vertical axis) over time (horizontal axis). Generally, <code>ggplot2</code> works in layers. The following codes generates an empty plot:</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty plot</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/emptyPlot-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Empty ggplot layer.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To the empty plot, one can add fuhrer layers:</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a scatter plot </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/emptyPlot2-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Adding a scatter plot layer to the empty ggplot layer.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Add color for <code>Diet</code>. The graph above does not differentiate between the diets. Let’s use a different color for each diet.</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding colour for diet</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW,<span class="fu">aes</span>(Time,weight,<span class="at">colour=</span><span class="fu">factor</span>(Diet))) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_StatLearning_files/figure-html/addColourPlot-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Adding a further layer for shown the effect of the Diet.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>It is difficult to conclude anything from this graph as the points are printed on top of one another (with diet 1 underneath and diet 4 at the top).</p>
<p>To improve the plot, it will be handy to store <code>Diet</code> and <code>Time</code> as a <code>factor</code> variables.</p>
<p><strong>Factor Variables:</strong> Before we continue, we have to make an important change to the <code>CW</code> dataset by making <code>Diet</code> and <code>Time</code> <em>factor variables</em>. This means that R will treat them as categorical variables (see the <code>&lt;fct&gt;</code> variables below) instead of continuous variables. It will simplify our coding. The next section will explain the <code>mutate()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>CW <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">Diet =</span> <span class="fu">factor</span>(Diet))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>CW <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">Time =</span> <span class="fu">factor</span>(Time))</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(CW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 578
Columns: 4
$ Chick  &lt;dbl&gt; 18, 18, 16, 16, 16, 16, 16, 16, 16, 15, 15, 15, 15, 15, 15, 15,…
$ Diet   &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ Time   &lt;fct&gt; 0, 2, 0, 2, 4, 6, 8, 10, 12, 0, 2, 4, 6, 8, 10, 12, 14, 0, 2, 4…
$ weight &lt;dbl&gt; 39, 35, 41, 45, 49, 51, 57, 51, 54, 41, 49, 56, 64, 68, 68, 67,…</code></pre>
</div>
</div>
<p>The <code>facet_wrap()</code> function: To plot each diet separately in a grid using <code>facet_wrap()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding jitter to the points</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ch1_StatLearning_files/figure-html/ScatterPlot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- To overcome the issue of ovelapping points we can ***jitter*** the points using  -->
<!-- `geom_jitter()`. Replace the `geom_point()` above with `geom_jitter()`. What do you -->
<!-- observe? -->
<!-- ```{r jitterPlot2} -->
<!-- # Adding jitter to the points -->
<!-- ggplot(CW, aes(Time, weight, colour=Diet)) + -->
<!--   geom_jitter() + -->
<!--   facet_wrap(~Diet) + -->
<!--   theme(legend.position = "bottom") -->
<!-- ``` -->
<p><strong>Interpretation:</strong> Diet 4 has the least variability but we can’t really say anything about the mean effect of each diet although diet 3 seems to have the highest.</p>
<p>Next we will plot the <strong>mean changes</strong> over time for each diet using the <code>stat_summary()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">group=</span>Diet, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"line"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ch1_StatLearning_files/figure-html/meanlinesPlot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Interpretation:</strong> We can see that diet 3 has the highest mean weight gains by the end of the experiment. However, we don’t have any information about the variation (uncertainty) in the data.</p>
<p>To see variation between the different diets we use <code>geom_boxplot</code> to plot a box-whisker plot. A note of caution is that the number of chicks per diet is relatively low to produce this plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Chick Weight over Time by Diet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ch1_StatLearning_files/figure-html/boxPlot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Interpretation:</strong> Diet 3 seems to have the highest “average” weight gain but it has more variation than diet 4 which is consistent with our findings so far.</p>
<p>Let’s finish with a plot that you might include in a publication.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CW, <span class="fu">aes</span>(Time, weight, <span class="at">group=</span>Diet, </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter() +</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"line"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Chick Weight over Time by Diet"</span>) <span class="sc">+</span> </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time (days)"</span>) <span class="sc">+</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weight (grams)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ch1_StatLearning_files/figure-html/finalPlot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="tidyverse-data-wrangling-basics" class="level4" data-number="1.5.7.2">
<h4 data-number="1.5.7.2" class="anchored" data-anchor-id="tidyverse-data-wrangling-basics"><span class="header-section-number">1.5.7.2</span> Tidyverse: Data Wrangling Basics</h4>
<div class="cell">

</div>
<p>In this section we will learn how to wrangle (manipulate) datasets using the <code>tidyverse</code> package. Let’s start with the <code>mutate()</code>, <code>select()</code>, <code>rename()</code>, <code>filter()</code> and <code>arrange()</code> functions.</p>
<p><code>mutate()</code>: Adds a new variable (column) or modifies an existing one. We already used this above to create factor variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Added a column</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>CWm1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">weightKg =</span> weight<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>CWm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 5
  Chick Diet  Time  weight weightKg
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1    18 1     0         39    0.039
2    18 1     2         35    0.035
3    16 1     0         41    0.041
# … with 575 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify an existing column</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>CWm2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(CW, <span class="at">Diet =</span> <span class="fu">str_c</span>(<span class="st">"Diet "</span>, Diet))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>CWm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet   Time  weight
  &lt;dbl&gt; &lt;chr&gt;  &lt;fct&gt;  &lt;dbl&gt;
1    18 Diet 1 0         39
2    18 Diet 1 2         35
3    16 Diet 1 0         41
# … with 575 more rows</code></pre>
</div>
</div>
<p><code>select()</code>: Keeps, drops or reorders variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the weight variable from CWm1 using minus</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(CWm1, <span class="sc">-</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet  Time  weightKg
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1    18 1     0        0.039
2    18 1     2        0.035
3    16 1     0        0.041
# … with 575 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep variables Time, Diet and weightKg</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(CWm1, Chick, Time, Diet, weightKg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Time  Diet  weightKg
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1    18 0     1        0.039
2    18 2     1        0.035
3    16 0     1        0.041
# … with 575 more rows</code></pre>
</div>
</div>
<p><code>rename()</code>: Renames variables whilst keeping all variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">rename</span>(CW, <span class="at">Group =</span> Diet, <span class="at">Weight =</span> weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Group Time  Weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1    18 1     0         39
2    18 1     2         35
3    16 1     0         41
# … with 575 more rows</code></pre>
</div>
</div>
<p><code>filter()</code>: Keeps or drops observations (rows).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(CW, Time<span class="sc">==</span><span class="dv">21</span> <span class="sc">&amp;</span> weight<span class="sc">&gt;</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  Chick Diet  Time  weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1     7 1     21       305
2    29 2     21       309
3    21 2     21       331
# … with 5 more rows</code></pre>
</div>
</div>
<p>For comparing values in vectors use: <code>&lt;</code> (less than), <code>&gt;</code> (greater than), <code>&lt;=</code> (less than and equal to), <code>&gt;=</code> (greater than and equal to), <code>==</code> (equal to) and <code>!=</code> (not equal to). These can be combined logically using <code>&amp;</code> (and) and <code>|</code> (or).</p>
<p><code>arrange()</code>: Changes the order of the observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(CW, Chick, Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet  Time  weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1     1 1     0         42
2     1 1     2         51
3     1 1     4         59
# … with 575 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(CW, <span class="fu">desc</span>(weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 578 × 4
  Chick Diet  Time  weight
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
1    35 3     21       373
2    35 3     20       361
3    34 3     21       341
# … with 575 more rows</code></pre>
</div>
</div>
<p>What does the <code>desc()</code> do? Try using <code>desc(Time)</code>.</p>
</section>
<section id="the-pipe-operator" class="level4" data-number="1.5.7.3">
<h4 data-number="1.5.7.3" class="anchored" data-anchor-id="the-pipe-operator"><span class="header-section-number">1.5.7.3</span> The pipe operator <code>%&gt;%</code></h4>
<p>In reality you will end up doing multiple data wrangling steps that you want to save. The pipe operator <code>%&gt;%</code> makes your code nice and readable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>CW21 <span class="ot">&lt;-</span> CW <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Weight =</span> weight) <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">"Diet "</span>, Diet))) <span class="sc">%&gt;%</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Chick, Group, Time, Weight) <span class="sc">%&gt;%</span> </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Chick, Time) </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>CW21</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 95 × 4
  Chick Group  Time  Weight
  &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;  &lt;dbl&gt;
1     1 Diet 1 0         42
2     1 Diet 1 21       205
3     2 Diet 1 0         40
# … with 92 more rows</code></pre>
</div>
</div>
<p>Hint: To understand the code above we should read the pipe operator <code>%&gt;%</code> as “then”.</p>
<blockquote class="blockquote">
<p>Create a new dataset (object) called <code>CW21</code> using dataset <code>CW</code> <strong><em>then</em></strong> keep the data for days 0 and 21 <strong><em>then</em></strong> rename variable <code>weight</code> to <code>Weight</code> <strong><em>then</em></strong> create a variable called <code>Group</code> <strong><em>then</em></strong> keep variables <code>Chick</code>, <code>Group</code>, <code>Time</code> and <code>Weight</code> and <strong><em>then</em></strong> finally arrange the data by variables <code>Chick</code> and <code>Time</code>.</p>
</blockquote>
<p>This is the same code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>CW21 <span class="ot">&lt;-</span> CW <span class="sc">%&gt;%</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(., Time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(., <span class="at">Weight =</span> weight) <span class="sc">%&gt;%</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(., <span class="at">Group=</span><span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">"Diet "</span>,Diet))) <span class="sc">%&gt;%</span> </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(., Chick, Group, Time, Weight) <span class="sc">%&gt;%</span> </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(., Chick, Time) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The pipe operator, <code>%&gt;%</code>, replaces the dots (<code>.</code>) with whatever is returned from code preceding it. For example, the dot in <code>filter(., Time %in% c(0, 21))</code> is replaced by <code>CW</code>. The output of the <code>filter(...)</code> then replaces the dot in <code>rename(., Weight = weight)</code> and so on. Think of it as a data assembly line with each function doing its thing and passing it to the next.</p>
</section>
<section id="the-group_by-function" class="level4" data-number="1.5.7.4">
<h4 data-number="1.5.7.4" class="anchored" data-anchor-id="the-group_by-function"><span class="header-section-number">1.5.7.4</span> The <code>group_by()</code> function</h4>
<p>From the data visualizations above we concluded that the diet 3 has the highest mean and diet 4 the least variation. In this section, we will quantify the effects of the diets using <strong>summmary statistics</strong>. We start by looking at the number of observations and the mean by <strong>diet</strong> and <strong>time</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>mnsdCW <span class="ot">&lt;-</span> CW <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">Mean =</span> <span class="fu">mean</span>(weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Diet, Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Diet'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>mnsdCW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
# Groups:   Diet [4]
  Diet  Time      N  Mean
  &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;
1 1     0        20  41.4
2 1     2        20  47.2
3 1     4        19  56.5
# … with 45 more rows</code></pre>
</div>
</div>
<p>For each distinct combination of <code>Diet</code> and <code>Time</code>, the chick weight data is summarized into the number of observations (<code>N</code>) and the mean (<code>Mean</code>) of <code>weight</code>.</p>
<p><strong>Further summaries:</strong> Let’s also calculate the standard deviation, median, minimum and maximum values but only at days 0 and 21.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>sumCW <span class="ot">&lt;-</span>  CW <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(weight),</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">median</span>(weight),</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(weight),</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Diet, Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Diet'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>sumCW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
# Groups:   Diet [4]
  Diet  Time      N  Mean     SD Median   Min   Max
  &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1     0        20  41.4  0.995   41      39    43
2 1     21       16 178.  58.7    166      96   305
3 2     0        10  40.7  1.49    40.5    39    43
# … with 5 more rows</code></pre>
</div>
</div>
<p>Let’s make the summaries “prettier”, say, for a report or publication.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"knitr"</span>) <span class="co"># to use the kable() function</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>prettySumCW <span class="ot">&lt;-</span> sumCW <span class="sc">%&gt;%</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Mean (SD)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_c</span>(<span class="fu">format</span>(Mean, <span class="at">digits=</span><span class="dv">1</span>),</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">" ("</span>, <span class="fu">format</span>(SD, <span class="at">digits=</span><span class="dv">2</span>), <span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Range =</span> <span class="fu">str_c</span>(Min, <span class="st">" - "</span>, Max)) <span class="sc">%&gt;%</span> </span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(Diet, Time, N, <span class="st">`</span><span class="at">Mean (SD)</span><span class="st">`</span>, Median, Range) <span class="sc">%&gt;%</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">arrange</span>(Diet, Time) <span class="sc">%&gt;%</span> </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"latex"</span>)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>prettySumCW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> Diet </th>
   <th style="text-align:left;"> Time </th>
   <th style="text-align:right;"> N </th>
   <th style="text-align:left;"> Mean (SD) </th>
   <th style="text-align:right;"> Median </th>
   <th style="text-align:left;"> Range </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> 41 ( 0.99) </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:left;"> 39 - 43 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:left;"> 178 (58.70) </td>
   <td style="text-align:right;"> 166.0 </td>
   <td style="text-align:left;"> 96 - 305 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> 41 ( 1.5) </td>
   <td style="text-align:right;"> 40.5 </td>
   <td style="text-align:left;"> 39 - 43 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> 215 (78.1) </td>
   <td style="text-align:right;"> 212.5 </td>
   <td style="text-align:left;"> 74 - 331 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> 41 ( 1) </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:left;"> 39 - 42 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> 270 (72) </td>
   <td style="text-align:right;"> 281.0 </td>
   <td style="text-align:left;"> 147 - 373 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> 41 ( 1.1) </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:left;"> 39 - 42 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:left;"> 239 (43.3) </td>
   <td style="text-align:right;"> 237.0 </td>
   <td style="text-align:left;"> 196 - 322 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<!-- Eventually you should be able to produce a publication ready version as follows: -->
<!-- ```{r prettyKable, echo = FALSE} -->
<!-- library("knitr") -->
<!-- prettySumCW %>%  -->
<!-- kable("latex", booktabs = TRUE, linesep = "", align = "cccrc") %>%  -->
<!--   #kable_styling(position = "center") %>%  -->
<!--   row_spec(0, bold = TRUE) %>% -->
<!--   row_spec(c(2, 4, 6, 8), background = "lightgray") -->
<!--   # Uncomment below once bugs are fixed - https://github.com/haozhu233/kableExtra/issues/243 & 237 -->
<!--   # column_spec(1, bold = T) %>% -->
<!--   # collapse_rows(columns = 1, latex_hline = "none", valign = "top") -->
<!-- ``` -->
<p><strong>Interpretation:</strong> This summary table offers the same interpretation as before, namely that diet 3 has the highest mean and median weights at day 21 but a higher variation than group 4. However it should be noted that at day 21, diet 1 lost 4 chicks from 20 that started and diet 4 lost 1 from 10. This could be a sign of some health related issues.</p>
<div class="cell">

</div>
</section>
</section>
<section id="further-links" class="level3" data-number="1.5.8">
<h3 data-number="1.5.8" class="anchored" data-anchor-id="further-links"><span class="header-section-number">1.5.8</span> Further Links</h3>
<section id="further-r-intros" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="further-r-intros">Further R-Intros</h4>
<ul>
<li><p>https://eddelbuettel.github.io/gsir-te/Getting-Started-in-R.pdf</p></li>
<li><p>https://www.datacamp.com/courses/free-introduction-to-r</p></li>
<li><p>https://swcarpentry.github.io/r-novice-gapminder/</p></li>
<li><p>https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</p></li>
</ul>
</section>
<section id="version-control-gitgithub" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="version-control-gitgithub">Version Control (Git/GitHub)</h4>
<ul>
<li><p>https://support.rstudio.com/hc/en-us/articles/200532077-Version-Control-with-Git-and-SVN</p></li>
<li><p>http://happygitwithr.com/</p></li>
<li><p>https://www.gitkraken.com/</p></li>
</ul>
</section>
<section id="r-ladies" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="r-ladies">R-Ladies</h4>
<ul>
<li>https://rladies.org/</li>
</ul>
</section>
</section>
</section>
<section id="exercises" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">1.6</span> Exercises</h2>
<p>Prepare the following exercises of Chapter 2 in our course textbook <code>ISLR</code>:</p>
<ul>
<li>Exercise 7</li>
<li>Exercise 8</li>
<li>Exercise 9</li>
</ul>
<!-- {{< include Ch1_Solutions.qmd >}} -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Organization of the Course</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch2_LinearRegression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>